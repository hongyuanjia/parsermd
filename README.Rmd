---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README",
  out.width = "100%"
)

options(width = 80)
```

# parsermd

<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
<!-- badges: end -->

The goal of parsermd is to extract the content of an Rmarkdown file to allow for programmatic interactions with the code chunks and markdown content. The goal is to capture the fundamental structure of the document and as such we do not attempt to parse every detail of the Rmd. Specifically, the yaml front matter, markdown text, and R code are read as text lines allowing them to be processed latter with sepecific tools like `yaml::read_yaml` or `base::parse`.

## Installation

You can install the released version of parsermd from [GitHub](https://github.com/rundel/parsermd) with:

```r
remotes::install_github("rundel/parsermd")
```

```{r}
library(parsermd)
```

## Example

This is a basic example which shows you the basic abstract syntax tree (AST) that results from parsing a simple Rmd file,

```{r example}
rmd = parsermd::parse_rmd(system.file("minimal.Rmd", package = "parsermd"))
```

The RMarkdown document is parsed and stored in a flat, ordered list object containing tagged elements. By default the package will present a heirachical view of the document where chunks and markdown text are nested within headings, which is shown by the default print method for `rmd_ast` objects.

```{r tree}
print(rmd)
```

If you would prefer to see the underlying flat structure, this can be printed by setting `use_headings = FALSE` with `print`.

```{r no_headings}
print(rmd, use_headings = FALSE)
```

Additionally, to ease the manipulation of the AST the package supports the transformation of the object into a tidy tibble with `as_tibble` or `as.data.frame` (both return a tibble).

```{r tibble}
as_tibble(rmd)
```

and it is possible to convert from these data frames back into an `rmd_ast`.

```{r as_ast}
as_ast( as_tibble(rmd) )
```

Finally, we can also convert the `rmd_ast` back into an RMarkdown document via `as_document`

```{r as_doc}
cat(
  as_document(rmd),
  sep = "\n"
)
```
